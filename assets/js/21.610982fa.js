(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{501:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("近期一直在搞Pixiv相关的东西，也拿到了"),a("a",{attrs:{href:"https://yojigen.tech/archives/pivisionm.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Pivision"),a("OutboundLink")],1),s._v("的原作者reiya的正式授权，成了新的维护者。于是一个又一个的问题摆在我面前，我必须要把她们一个一个推倒。\n目前比较棘手的问题是：如何注册账号。实际上解决办法也很简单，反带P站就完事了。但这会出现另一个严重的问题：反带了P站，大量的图片会让我的小服务器吃不消。这时候，我发现了Cloudflare Workers。")]),s._v(" "),a("h2",{attrs:{id:"简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/mouyase/Yojigen.Tech@gh-pages/assets/19/cover.jpg",alt:""}})]),s._v(" "),a("p",[s._v("Cloudflare提供了免费的额度，每天10万次请求而不计算流量，简直就是用来反带的神器！")]),s._v(" "),a("h2",{attrs:{id:"教程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#教程"}},[s._v("#")]),s._v(" 教程")]),s._v(" "),a("h3",{attrs:{id:"_1-前提准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-前提准备"}},[s._v("#")]),s._v(" 1. 前提准备")]),s._v(" "),a("ul",[a("li",[s._v("一个域名")]),s._v(" "),a("li",[s._v("域名要使用Cloudflare的NS解析")])]),s._v(" "),a("h3",{attrs:{id:"_2-步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-步骤"}},[s._v("#")]),s._v(" 2. 步骤")]),s._v(" "),a("p",[s._v("首先注册一个Cloudflare账号（估计大多数人都有），之后把你的域名使用Cloudflare解析（这个过程我觉得没必要详细讲了……）")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/mouyase/Yojigen.Tech@gh-pages/assets/19/1.jpg",alt:""}})]),s._v(" "),a("p",[s._v("然后打开你的域名管理页面，点击上面的Workers，再点击Launch Editor，进入脚本编辑器。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/mouyase/Yojigen.Tech@gh-pages/assets/19/2.jpg",alt:""}})]),s._v(" "),a("p",[s._v("在编辑器中，点击左侧的Add script，之后输入脚本的名称，随便填一个"),a("code",[s._v("pximg")]),s._v("就好，之后点击Confirm创建脚本。")]),s._v(" "),a("p",[s._v("之后左侧会多出来一个脚本，点进去开始编辑。")]),s._v(" "),a("p",[s._v("删除掉里面所有的代码，粘贴下面的代码进去。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fetch"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("event")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" url "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hostname "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"i.pximg.net"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" request "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("respondWith")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Referer'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'https://www.pixiv.net/'")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/mouyase/Yojigen.Tech@gh-pages/assets/19/3.jpg",alt:""}})]),s._v(" "),a("p",[s._v("就像这样，然后点击save保存脚本。然后点击左上角的Dashboard返回域名面板。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/mouyase/Yojigen.Tech@gh-pages/assets/19/4.jpg",alt:""}})]),s._v(" "),a("p",[s._v("之后点击Add route，填写"),a("code",[s._v("https://你的域名/*")]),s._v("，并且下面选择刚刚创建的脚本，举例如图。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/mouyase/Yojigen.Tech@gh-pages/assets/19/5.jpg",alt:""}})]),s._v(" "),a("p",[s._v("再之后点击"),a("code",[s._v("new Workers dashboard")]),s._v("，根据提示创建一个二级域名。例如我的二级域名是"),a("code",[s._v("4cy.workers.dev")]),s._v("，而刚刚创建的脚本的域名就是"),a("code",[s._v("pximg.4cy.workers.dev")]),s._v("。")]),s._v(" "),a("p",[s._v("最后一步，到DNS页面，添加一个CNAME记录到你的脚本域名下，并开启云加速。")]),s._v(" "),a("p",[s._v("至此，你就可以使用你的域名来作为Pixiv的图片反向代理了。")])])}),[],!1,null,null,null);t.default=e.exports}}]);